{"remainingRequest":"/Users/songyu/IdeaProjects/yiqing-admin-1/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!/Users/songyu/IdeaProjects/yiqing-admin-1/src/views/Health/HealthList.vue?vue&type=style&index=0&id=5228e4fa&lang=less&scoped=true&","dependencies":[{"path":"/Users/songyu/IdeaProjects/yiqing-admin-1/src/views/Health/HealthList.vue","mtime":1621490343093},{"path":"/Users/songyu/IdeaProjects/yiqing-admin-1/node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/songyu/IdeaProjects/yiqing-admin-1/node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/songyu/IdeaProjects/yiqing-admin-1/node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/songyu/IdeaProjects/yiqing-admin-1/node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/songyu/IdeaProjects/yiqing-admin-1/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/songyu/IdeaProjects/yiqing-admin-1/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZWwtaW5wdXQtZ3JvdXAgewogIHdpZHRoOiA0MCU7Cn0KCi5oZWFkZXItbWVudSB7CiAgbWFyZ2luLWJvdHRvbTogNXB4OwogIHBhZGRpbmc6IDVweDsKICB0ZXh0LWFsaWduOiBsZWZ0OwogIG1hcmdpbi1ib3R0b206IDVweDsKfQoKLmZvb3Rlci1idXR0b24gewogIG1hcmdpbi10b3A6IDEwcHg7Cn0KCi5hZGRidG4gewogIG1hcmdpbi1sZWZ0OiAyNXB4Owp9CgouaGVhZGVyLXNlYXJjaCB7CiAgbWFyZ2luLWxlZnQ6IDVweDsKfQo="},{"version":3,"sources":["HealthList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuZA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"HealthList.vue","sourceRoot":"src/views/Health","sourcesContent":["<template>\n  <div>\n    <!-- 功能 -->\n    <div class=\"header-menu\">\n      <el-input class=\"header-search\" placeholder=\"搜索健康打卡记录（学号）\" v-model=\"keyword.keyword\" style=\"width:20%;\">\n      </el-input>\n\n      <el-select v-model=\"keyword.cough\" placeholder=\"咳嗽\" clearable>\n        <el-option key=\"all\" label=\"全部\" value=\" \"></el-option>\n        <el-option key=\"0\" label=\"无\" value=\"0\"></el-option>\n        <el-option key=\"1\" label=\"有\" value=\"1\"></el-option>\n      </el-select>\n\n      <el-select v-model=\"keyword.fever\" placeholder=\"发烧\" clearable>\n        <el-option key=\"all\" label=\"全部\" value=\" \"></el-option>\n        <el-option key=\"0\" label=\"无\" value=\"0\"></el-option>\n        <el-option key=\"1\" label=\"有\" value=\"1\"></el-option>\n      </el-select>\n\n      <el-select v-model=\"keyword.temperature\" placeholder=\"体温\" clearable>\n        <el-option key=\"1\" label=\"异常\" value=\"37.2\"></el-option>\n      </el-select>\n\n      <el-button class=\"header-search\" slot=\"append\" type=\"primary\" icon=\"el-icon-search\" @click=\"searchStudent\">搜索\n      </el-button>\n\n      <el-button type=\"primary\" @click=\"showAddForm()\" class=\"addbtn\">添加</el-button>\n\n      <el-button class=\"header-search\" type=\"primary\" icon=\"el-icon-document\" @click=\"handleDownload\">\n        导出Excel\n      </el-button>\n\n    </div>\n    <!-- 数据显示 -->\n    <el-table :data=\"studentData\" size=\"mini\" :stripe=\"true\" :highlight-current-row=\"true\">\n      <el-table-column label=\"序号\" type=\"selection\"></el-table-column>\n      <el-table-column prop=\"userId\" label=\"学号\" fixed width=\"100\"></el-table-column>\n      <el-table-column prop=\"username\" label=\"姓名\"></el-table-column>\n      <el-table-column prop=\"dept\" label=\"学院\"></el-table-column>\n      <el-table-column prop=\"major\" label=\"班级\"></el-table-column>\n      <el-table-column prop=\"createTime\" label=\"时间\"></el-table-column>\n      <el-table-column prop=\"type\" label=\"时间段\"></el-table-column>\n      <el-table-column prop=\"visit\" label=\"行程轨迹\"></el-table-column>\n      <el-table-column prop=\"temperature\" label=\"体温\">\n        <template slot-scope=\"scope\">\n          <el-tag v-if=\"scope.row.temperature>37.2\" type=\"danger\" effect=\"dark\">{{scope.row.temperature}}</el-tag>\n          <el-tag v-else plain>{{scope.row.temperature}}</el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"cough\" label=\"咳嗽\">\n        <template slot-scope=\"scope\">\n          <el-tag v-if=\"scope.row.cough==0\" plain>无</el-tag>\n          <el-tag v-else-if=\"scope.row.cough==1\" type=\"danger\" effect=\"dark\">有</el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"fever\" label=\"发烧\">\n        <template slot-scope=\"scope\">\n          <el-tag v-if=\"scope.row.fever==0\" plain>无</el-tag>\n          <el-tag v-else-if=\"scope.row.fever==1\" type=\"danger\" effect=\"dark\">有</el-tag>\n        </template>\n      </el-table-column>\n\n      <el-table-column prop=\"operation\" label=\"操作\" fixed=\"right\" width=\"220\">\n        <template slot-scope=\"scope\">\n          <!--      <el-button type=\"text\" icon=\"el-icon-setting\" size=\"mini\" @click=\"resetById(scope.$index, scope.row)\">重置密码</el-button>-->\n          <!--          <el-button v-if=\"scope.row.status==0\" type=\"success\" icon=\"el-icon-check\" circle-->\n          <!--                     @click=\"statusById(scope.$index, scope.row, 1)\"></el-button>-->\n          <!--          <el-button v-if=\"scope.row.status==0\" type=\"danger\" icon=\"el-icon-close\" circle-->\n          <!--                     @click=\"statusById(scope.$index, scope.row, 2)\"></el-button>-->\n          <!--          <el-button v-if=\"role == 'normal'\" type=\"primary\" icon=\"el-icon-edit\" circle-->\n          <!--                     @click=\"showEditForm(scope.$index, scope.row)\"></el-button>-->\n          <el-button icon=\"el-icon-delete\" circle @click=\"deleteById(scope.$index, scope.row)\"></el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <el-dialog title=\"添加\" :visible.sync=\"visibleAddForm\">\n      <el-form\n              :model=\"addFormdata\"\n              label-position=\"left\"\n              label-width=\"80px\"\n              :rules=\"editFormRules\"\n      >\n        <el-form-item label=\"学号\" prop=\"userId\">\n          <el-input v-model=\"addFormdata.userId\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"时间段\" prop=\"type\">\n          <el-radio-group v-model=\"addFormdata.type\">\n            <el-radio-button label=\"上午\">上午</el-radio-button>\n            <el-radio-button label=\"中午\">中午</el-radio-button>\n            <el-radio-button label=\"下午\">下午</el-radio-button>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item label=\"行程轨迹\" prop=\"visit\">\n          <el-input v-model=\"addFormdata.visit\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"体温\" prop=\"temperature\">\n          <el-input type=\"number\" v-model=\"addFormdata.temperature\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"咳嗽\" prop=\"cough\">\n          <el-radio v-model=\"addFormdata.cough\" label=\"0\" border>无</el-radio>\n          <el-radio v-model=\"addFormdata.cough\" label=\"1\" border>有</el-radio>\n        </el-form-item>\n        <el-form-item label=\"发烧\" prop=\"fever\">\n          <el-radio v-model=\"addFormdata.fever\" label=\"0\" border>无</el-radio>\n          <el-radio v-model=\"addFormdata.fever\" label=\"1\" border>有</el-radio>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"visibleAddForm = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"addCommit()\">提 交</el-button>\n      </div>\n    </el-dialog>\n\n    <el-dialog title=\"编辑\" :visible.sync=\"visibleModifyForm\">\n      <el-form\n              :model=\"editFormData\"\n              label-position=\"left\"\n              label-width=\"80px\">\n        <el-form-item label=\"学号\" prop=\"userId\">\n          <el-input v-model=\"editFormData.userId\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"时间段\" prop=\"type\">\n          <el-radio-group v-model=\"editFormData.type\">\n            <el-radio-button label=\"admin\">辅导员</el-radio-button>\n            <el-radio-button label=\"normal\">学生</el-radio-button>\n            <el-radio-button label=\"ban\">封禁用户</el-radio-button>\n            <el-radio-button label=\"other\">其他用户</el-radio-button>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item label=\"行程轨迹\" prop=\"visit\">\n          <el-input v-model=\"editFormData.visit\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"体温\" prop=\"temperature\">\n          <el-input type=\"number\" v-model=\"editFormData.temperature\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"咳嗽\" prop=\"cough\">\n          <el-radio v-model=\"editFormData.cough\" label=\"0\" border>无</el-radio>\n          <el-radio v-model=\"editFormData.cough\" label=\"1\" border>有</el-radio>\n        </el-form-item>\n        <el-form-item label=\"发烧\" prop=\"fever\">\n          <el-radio v-model=\"editFormData.fever\" label=\"0\" border>无</el-radio>\n          <el-radio v-model=\"editFormData.fever\" label=\"1\" border>有</el-radio>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"visibleModifyForm = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"commit()\">提 交</el-button>\n      </div>\n    </el-dialog>\n\n    <!-- 上一页，当前页，下一页 -->\n    <div class=\"footer-button\">\n      <el-pagination\n              @size-change=\"handleSizeChange\"\n              @current-change=\"handleCurrentChange\"\n              :current-page.sync=\"page\"\n              :page-size=\"pageSize\"\n              layout=\"total, prev, pager, next\"\n              :total=\"total\"\n      ></el-pagination>\n    </div>\n  </div>\n</template>\n\n<script>\n  import {add, del, modify, get, search} from \"@/api/health\";\n\n  export default {\n    name: \"HealthList\",\n    // components: { FilenameOption, AutoWidthOption, BookTypeOption },\n    data() {\n      return {\n        role: this.$store.state.user.roles,\n        studentData: [],\n        editFormData: [],\n        addFormdata: {\n          userId: this.$store.state.user.id,\n        },\n        visibleAddForm: false,\n        visibleModifyForm: false,\n        keyword: {\n          group: '',\n          keyword: '',\n          fever: '',\n          temperature: '',\n          cough: '',\n          role: this.$store.state.user.roles,\n          userId: this.$store.state.user.id,\n          major: this.$store.state.user.major\n        },\n        page: 1,\n        pageSize: 10,\n        total: 0,\n        value1: \"\", // 年级\n        value2: \"\", // 班级\n        type: [\n          {\n            value: \"1\",\n            label: \"\"\n          }\n        ],\n        visibleForm: false,\n        editFormRules: {\n          username: [{required: true, message: \"请输入昵称\", trigger: \"blur\"}],\n          realname: [{required: true, message: \"请输入姓名\", trigger: \"blur\"}],\n          telephone: [{required: true, message: \"请输入联系电话\", trigger: \"blur\"}],\n          email: [{required: true, message: \"请输入邮件\", trigger: \"blur\"}],\n          address: [{required: true, message: \"请输入地址\", trigger: \"blur\"}],\n        }\n      };\n    },\n\n    mounted() {\n      this.allStudent();\n    },\n\n    methods: {\n      handleDownload() {\n        this.downloadLoading = true\n        import('@/vendor/Export2Excel').then(excel => {\n          const tHeader = ['学号','时间' ,'时间段', '行程轨迹', '体温', '咳嗽','发烧']\n          const filterVal = ['userId','createTime', 'type', 'visit', 'temperature', 'cough','fever']\n          const list = this.studentData\n          const data = this.formatJson(filterVal, list)\n          excel.export_json_to_excel({\n            header: tHeader,\n            data,\n            filename: this.filename,\n            autoWidth: this.autoWidth,\n            bookType: this.bookType\n          })\n        })\n      },\n      formatJson(filterVal, jsonData) {\n        return jsonData.map(v => filterVal.map(j => {\n          if (j === 'fever'|| j === 'cough') {\n            return this.formatH1(v[j])\n          } else {\n            return v[j]\n          }\n        }))\n      }\n      ,\n      formatH1(data){\n        if (data == '0') {\n          return '无'\n        }else{\n          return '有'\n        }\n      }\n      ,\n      statusFormatter(data) {\n        if (data.status == '0') {\n          return '待审批'\n        }\n      },\n      addStudent() {\n        this.visibleAddForm = true;\n      },\n      addCommit() {\n        console.log(this.addFormdata);\n        add(this.addFormdata)\n          .then(res => {\n            if (res.code == 0) {\n              this.visibleAddForm = false;\n              this.$message({message: \"添加成功\", type: \"success\"});\n              this.allStudent()\n            }\n          })\n          .catch(error => {\n            this.$message.error(\"添加失败\");\n          });\n      },\n      // 清空年级回到查询所有用户\n      gradeListener() {\n        this.allStudent()\n        this.value2 = ''\n      },\n\n      // 清空班级回到查询所有班级\n      classListener() {\n\n      },\n\n      /***\n       * 编辑提交\n       */\n      commit() {\n        this.modifyStudent(this.editFormData)\n      },\n\n      inputListener() {\n        this.allStudent()\n      },\n\n      /**\n       * 查询所有\n       */\n      allStudent() {\n        get(this.page,this.pageSize,this.role,\n          this.keyword.userId, this.keyword.major).then(res => {\n          let ret = res.data\n          console.log(ret)\n          this.studentData = ret.records\n          this.total = ret.total\n        })\n          .catch(error => {\n            this.$message.error(\"查询列表失败\")\n          });\n      },\n\n      /**\n       * 关键字查询\n       */\n      searchStudent() {\n        search(this.keyword)\n          .then(res => {\n            let ret = res.data\n            this.studentData = ret.records\n            this.total = ret.total\n            this.$message({message: \"查询成功\", type: \"success\"})\n          })\n          .catch(error => {\n            this.$message.error(\"查询失败\")\n          });\n      },\n\n      resetById(index, row) {\n        this.resetPassword(row.id);\n      },\n\n      resetPassword(id) {\n        modify({\"id\": id, \"password\": \"123456\"})\n          .then(res => {\n            this.$message({message: \"重置密码成功\", type: \"success\"});\n          })\n          .catch(error => {\n            this.$message.error(\"重置密码失败\");\n          });\n      },\n\n      deleteById(index, row) {\n        this.deleteRequestById(row.id)\n      },\n\n      deleteRequestById(id) {\n        del(id).then(res => {\n          this.$message({message: \"删除成功\", type: \"success\"})\n          this.allStudent()\n        }).catch(error => {\n          this.$message.error(\"删除失败\")\n        });\n      },\n\n      /*审核状态*/\n      statusById(index, row, status) {\n        this.statusRequestById(row.id, status)\n      },\n\n      statusRequestById(id, status) {\n        modify({\"id\": id, \"status\": status}).then(res => {\n          this.$message({message: \"处理成功\", type: \"success\"})\n          this.allStudent()\n        }).catch(error => {\n          this.$message.error(\"处理失败\")\n        });\n      },\n\n      /**\n       * 编辑用户\n       */\n      showEditForm(index, row) {\n        this.editFormData = row\n        this.visibleModifyForm = true\n      },\n\n      /**\n       * 更新用户\n       */\n      modifyStudent(modifyData) {\n        modify(modifyData)\n          .then(res => {\n            this.$message({message: \"更新成功\", type: \"success\"})\n            this.allStudent()\n            this.visibleForm = false\n          })\n          .catch(error => {\n            this.$message.error(\"更新失败\")\n          });\n      },\n\n      handleSizeChange() {\n      },\n\n      handleCurrentChange(v) {\n        this.page = v\n        this.allStudent()\n      },\n      showAddForm() {\n        this.visibleAddForm = true;\n      },\n    }\n  };\n</script>\n\n<style lang=\"less\" scoped>\n  .el-input-group {\n    width: 40%;\n  }\n\n  .header-menu {\n    margin-bottom: 5px;\n    padding: 5px;\n    text-align: left;\n    margin-bottom: 5px;\n  }\n\n  .footer-button {\n    margin-top: 10px;\n  }\n\n  .addbtn {\n    margin-left: 25px;\n  }\n\n  .header-search {\n    margin-left: 5px;\n  }\n</style>\n"]}]}